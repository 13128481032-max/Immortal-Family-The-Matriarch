# 🎭 剧情系统更新日志

## 版本 1.0.0 - 2026-01-25

### ✨ 新增功能

#### 1. 双轨剧情系统
- 🌹 **红尘羁绊·伴侣篇**：20个高质量浪漫剧情
  - 高冷/禁欲型 × 5
  - 病娇/占有型 × 5
  - 温润/忠犬型 × 5
  - 风流/魅惑型 × 5

- 👨‍👩‍👧 **血脉温情·子女篇**：15个温馨亲情剧情
  - 幼年期（0-10岁）× 5
  - 少年期（11-18岁）× 5
  - 成年期（18岁+）× 5

#### 2. 智能匹配系统
- 根据 NPC 性格标签自动匹配剧情风格
- 根据子女年龄自动切换剧情主题
- 好感度阈值控制（60+ 解锁浪漫剧情）

#### 3. UI 优化
- NPC 卡片新增 **💕 深入互动** 按钮（好感 60+ 显示）
- 子女卡片新增 **🏡 亲子时光** 按钮
- 按钮颜色区分功能类型

---

### 📝 文件改动

#### 新增文件
- `docs/剧情系统使用指南.md` - 完整的使用文档

#### 修改文件
- `src/game/textEngine.js`
  - 新增 `coldTypeRomance` 剧情库（5条）
  - 新增 `yandereTypeRomance` 剧情库（5条）
  - 新增 `gentleTypeRomance` 剧情库（5条）
  - 新增 `flirtyTypeRomance` 剧情库（5条）
  - 新增 `childToddlerEvents` 剧情库（5条）
  - 新增 `childTeenEvents` 剧情库（5条）
  - 新增 `childAdultEvents` 剧情库（5条）
  - 新增 `getRandomRomanceEvent()` 辅助函数
  - 新增 `getRandomChildEvent()` 辅助函数
  - **导出** `getRandomInteractionEvent()` 主函数

- `src/components/NpcCard/index.jsx`
  - 新增"深入互动"按钮（条件显示）
  - 新增"亲子时光"按钮（条件显示）
  - 优化按钮布局

- `src/App.jsx`
  - 导入 `getRandomInteractionEvent` 函数
  - 在 `handleNpcInteract` 中新增 `ROMANCE` 处理逻辑
  - 在 `handleNpcInteract` 中新增 `FAMILY` 处理逻辑

---

### 🎯 剧情特色

#### 感官描写
所有剧情都包含丰富的感官细节：
- 👁️ 视觉：眼神、动作、神态
- 👂 听觉：声音、语调、呼吸
- 🤚 触觉：温度、力道、质感

#### 性格差异化
不同性格的 NPC 有完全不同的互动体验：
```
高冷型："忍着点……别乱动，否则我不敢保证还能止乎礼。"
病娇型："真想把你的心剖出来看看，上面到底有没有刻着我的名字。"
温柔型："昨夜风大，怕你着凉，便守了一夜。"
风流型："道友深夜造访，可是长夜漫漫，无心睡眠？"
```

#### 时间跨度感
子女剧情会随年龄演变：
- **幼年**：依赖、撒娇、童真
- **少年**：叛逆、努力、证明自己
- **成年**：反哺、责任、保护父母

---

### 🔧 技术实现

#### 触发机制
```javascript
// 伴侣剧情：好感度 ≥ 60
if (npc.relationship?.affection >= 60 && !npc.isChild) {
  // 触发浪漫剧情
}

// 子女剧情：任意好感度
if (npc.isChild) {
  // 根据年龄触发对应剧情
}
```

#### 性格匹配逻辑
```javascript
const traitMap = {
  '高冷': 'COLD',
  '病娇': 'YANDERE',
  '温柔': 'GENTLE',
  '风流': 'FLIRTY'
};
```

#### 好感度奖励
- 浪漫剧情：+5 ~ +10
- 亲情剧情：+4 ~ +15
- 普通闲聊：+2

---

### 📊 数据统计

| 类型 | 数量 | 平均字数 |
|------|------|----------|
| 伴侣剧情 | 20 | ~80字 |
| 子女剧情 | 15 | ~85字 |
| 总计 | 35 | ~82字 |

---

### 🎮 玩法建议

#### 攻略流程
1. **初期（好感 0-30）**：多用闲聊刷好感
2. **中期（好感 30-60）**：送礼提升效率
3. **高期（好感 60+）**：解锁深入互动，体验高质量剧情
4. **满好感（80+）**：解锁劝生功能

#### 剧情收集
- 每个性格类型的 NPC 至少攻略一个
- 培养不同年龄段的子女，体验完整成长故事
- 记录最喜欢的剧情片段

---

### 🐛 已知问题

无

---

### 🔮 未来计划

#### v1.1.0（计划中）
- [ ] 增加每个类型剧情到 10 条
- [ ] 添加季节限定剧情（春游、中秋）
- [ ] 添加境界突破特殊剧情

#### v1.2.0（计划中）
- [ ] 剧情选项分支系统
- [ ] 回忆录功能（可重看历史剧情）
- [ ] 剧情成就系统

#### v2.0.0（远期规划）
- [ ] 剧情插图系统
- [ ] 语音配音（TTS）
- [ ] 剧情编辑器

---

### 🙏 致谢

感谢原需求提供者提供的详细剧情文本和设计思路！

---

### 📞 反馈

如有建议或发现问题，请在 GitHub Issues 中提出。

---

**最后更新时间**：2026-01-25  
**维护者**：GitHub Copilot
