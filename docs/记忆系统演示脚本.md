# 记忆系统演示脚本

## 🎬 演示流程（5分钟）

### 场景 1: 系统初始化（30秒）

**操作:**
1. 打开游戏
2. 按 F12 打开控制台
3. 输入: `console.log(gameState.npcs[0].memories)`

**预期结果:**
```javascript
{
  profile: { name: "陆昭", personality: "坚韧", ... },
  milestones: [],
  recentEvents: [],
  longTermSummary: "",
  meta: { totalEvents: 0, ... }
}
```

**说明:** "✅ 记忆系统已自动初始化"

---

### 场景 2: 触发生子事件（1分钟）

**操作:**
1. 找到好感度高的 NPC（如陆昭）
2. 点击"劝生"（前提：已结为道侣）
3. 选择劝说策略
4. 等待 9 个月（加速时间）
5. 观察生子日志

**预期结果:**
```
【诞子】陆昭为你诞下一子：张小凡（男，天赋炼气）
[记忆管理器] 陆昭 已记录生子事件: 张小凡
```

**验证记忆:**
```javascript
console.log(gameState.npcs[0].memories.milestones[0]);
// 输出:
// {
//   event: "为你生子",
//   detail: "为你诞下张小凡，历经生死劫难...",
//   emotionalImpact: "刻骨铭心",
//   tags: ["生子", "孩子", "张小凡", ...]
// }
```

---

### 场景 3: 查看回忆录（30秒）

**操作:**
1. 点击陆昭的头像
2. 切换到"📖 回忆录"标签
3. 查看显示的记忆

**预期展示:**
```
✨ 刻骨铭心的记忆 (1)

1. 为你生子                     [刻骨铭心]
   ⏰ 2026年1月26日
   "为你诞下张小凡，历经生死劫难，甚至为此损耗了修为根基。
    看着孩儿一天天长大，当年的痛，便都不算什么了。"
   #生子 #孩子 #张小凡 #牺牲
```

---

### 场景 4: 对话测试 - 无关键词（1分钟）

**操作:**
1. 切换到"💬 传音对话"标签
2. 输入: "天气真好"
3. 观察 AI 回复

**预期回复:**
```
嗯，今日确实风和日丽。
```

**说明:** 普通对话，不涉及记忆

---

### 场景 5: 对话测试 - 触发关键词（2分钟）

#### Test 1: 询问孩子

**操作:** 输入 "我们的孩子怎么样？"

**系统行为:**
```
→ 检测关键词: ["孩子"]
→ 唤起记忆: "为你生子（天元5年春）"
→ 注入指令: "请表现出为人父母的温情"
```

**预期回复:**
```
小凡很好，已经长到X岁了，最近在修炼上颇有天赋。
看着他一天天长大，我心中甚是欣慰。
```

#### Test 2: 询问生产经历

**操作:** 输入 "那次生产你受苦了吧？"

**系统行为:**
```
→ 检测关键词: ["生", "苦"]
→ 唤起记忆: "难产、损耗修为"
→ 注入指令: "请回忆起生产之痛"
```

**预期回复:**
```
何止是苦...那种撕心裂肺的痛，我这辈子都忘不了。
但只要看到小凡健康成长，便觉得一切都值得。
```

#### Test 3: 询问感受

**操作:** 输入 "你后悔吗？"

**系统行为:**
```
→ 检测关键词: ["后悔"]
→ 唤起记忆: 所有里程碑
→ 注入指令: "请结合过往经历真诚回应"
```

**预期回复:**
```
当年为你损耗修为之时，我未曾犹豫。
如今看你我子女成才，这点代价又算得了什么？
```

---

### 场景 6: 对比效果（1分钟）

#### 创建对照组（无记忆）

**操作:**
1. 清空陆昭的记忆: 
   ```javascript
   MemoryManager.clearAllMemories(gameState.npcs[0])
   ```
2. 再次问: "你后悔吗？"

**预期回复（无记忆）:**
```
我不后悔，修行路本就艰辛。
```

#### 恢复记忆

**操作:**
1. 重新添加记忆: 
   ```javascript
   MemoryManager.onChildBirth(
     gameState.npcs[0], 
     { name: "张小凡" }, 
     { difficulty: "难产", sacrifice: true }
   )
   ```
2. 再次问: "你后悔吗？"

**预期回复（有记忆）:**
```
看着小凡长大，当年的痛都不算什么了。
```

**对比说明:** "✅ 记忆让对话变得有血有肉"

---

## 🎯 关键演示点

### 演示 A: 记忆的持久性

```
Day 1: 生子事件发生
Day 2: 对话提到孩子 → AI 记得
Day 30: 再次对话 → AI 依然记得
```

**说明:** "里程碑是永久记忆，不会被遗忘"

### 演示 B: 关键词触发

```
输入 "孩子" → 唤起 "生子" 记忆
输入 "痛苦" → 唤起 "难产" 细节
输入 "后悔" → 综合评价过往
```

**说明:** "系统会根据对话内容动态加载相关记忆"

### 演示 C: 记忆分级

```
送普通礼物（+5好感） → 近期事件
送贵重礼物（+25好感） → 升级为里程碑
```

**说明:** "重要的事情会被永久记住"

---

## 📸 建议截图

1. **回忆录界面** - 展示里程碑的精美排版
2. **对话效果对比** - 有记忆 vs 无记忆的回复差异
3. **控制台输出** - 展示记忆数据结构
4. **关键词检测** - 高亮显示被检测到的关键词

---

## 🎤 演示话术

### 开场（20秒）

> "这是一个让 AI 拥有'记忆'的系统。
> 在传统的 AI 对话中，LLM 每次都是从零开始，无法记住游戏中发生的重要事情。
> 但通过记忆宫殿系统，NPC 会永远记得：他为你生过孩子、你们经历的生死时刻、你送过什么礼物...
> 当你问'你后悔吗？'时，他不再说空话，而是回忆起具体的细节。"

### 演示记忆录入（1分钟）

> "当游戏中发生重大事件时，系统会自动记录。
> 比如这里，NPC 刚刚为玩家生下了孩子。
> 系统自动判断这是'难产'，并且 NPC '损耗了修为'。
> 这些信息会被记录为'里程碑'，永久保存。"

（展示控制台输出）

> "看，这里就是刚刚记录的里程碑。
> 包含了事件名称、时间、详细描述、情感烙印等级，以及相关标签。"

### 演示对话效果（2分钟）

> "现在让我们看看记忆系统如何影响对话。
> 我问 NPC：'你还记得当年生孩子的事吗？'"

（输入并发送）

> "注意看，系统检测到了关键词'孩子'。
> 它会自动从里程碑中提取相关记忆，并注入到 Prompt 中。
> AI 收到的 System Prompt 不仅包含基础人设，还包含了刚才那段'生子'的详细经历。"

（展示 AI 回复）

> "看，AI 的回复具体提到了：
> - 孩子的名字（张小凡）
> - 当时的痛苦（'撕心裂肺'）
> - 现在的感受（'一切都值得'）
> 
> 这不再是空洞的客套话，而是带着真实记忆的深情回应。"

### 对比演示（1分钟）

> "让我们做个对比实验。
> 我先清空 NPC 的记忆，再问同样的问题。"

（清空记忆并提问）

> "看，没有记忆的 AI 回复是：'我不后悔，修行路本就艰辛。'
> 太抽象了，没有任何细节。"

（恢复记忆并提问）

> "现在恢复记忆，再问一次。
> AI 的回复是：'看着小凡长大，当年的痛都不算什么了。'
> 
> 差别一目了然。"

### 结尾（20秒）

> "这就是记忆宫殿系统的力量。
> 它让 LLM 拥有了'记忆'，让对话变得有血有肉，让角色真正'活'了起来。
> 
> 你可以在文档中找到完整的使用指南和技术细节。
> 现在，开始体验拥有记忆的修仙世界吧！"

---

## 🔧 调试检查清单

演示前确认：

- [ ] 所有 NPC 已初始化记忆系统
- [ ] 至少有一个 NPC 有里程碑记忆
- [ ] AI API 已配置（DeepSeek/OpenAI）
- [ ] 浏览器控制台无报错
- [ ] 回忆录标签页可正常显示
- [ ] 对话界面可正常发送消息

---

## 🎭 推荐演示顺序

1. **理论介绍**（开场话术）
2. **数据结构展示**（控制台查看）
3. **自动录入演示**（触发生子事件）
4. **UI 展示**（回忆录界面）
5. **对话效果**（关键词触发）
6. **对比实验**（有记忆 vs 无记忆）
7. **总结**（系统价值）

---

## 💡 演示技巧

1. **提前准备好存档** - 包含已生子的 NPC
2. **关闭自动播放** - 避免时间快速跳过
3. **清理控制台** - 展示时更清晰
4. **准备好测试问题** - 提前写好要问的话
5. **分屏展示** - 左边游戏，右边控制台/文档

---

## 🎤 互动问题（Q&A）

**Q: 记忆会影响游戏性能吗？**  
A: 几乎不会。每个 NPC 只增加约 6KB 数据，100 个 NPC 也就 600KB。

**Q: AI 会不会忘记记忆？**  
A: 不会。里程碑是永久记忆，每次对话都会注入。

**Q: 可以手动添加记忆吗？**  
A: 可以！使用 `addMilestone()` 函数即可。

**Q: 如果游戏时间跨度很长（100年），记忆会爆炸吗？**  
A: 不会。里程碑只保留最重要的（人为筛选），其余会被压缩为摘要。

**Q: 记忆系统需要额外配置吗？**  
A: 不需要！已自动集成，开箱即用。

---

## 🎁 Bonus: 隐藏彩蛋

在控制台输入以下命令可以解锁高级功能：

```javascript
// 查看测试函数
window.testMemorySystem();

// 为 NPC 添加一段史诗级记忆
import { addMilestone, EmotionalImpact } from './game/memorySystem.js';
addMilestone(gameState.npcs[0], {
  event: "与你共斩魔尊",
  time: "天元9年冬",
  detail: "在生死关头，我们背靠背击退了魔尊。那一刻，我知道你是我此生唯一的依靠。",
  emotionalImpact: EmotionalImpact.UNFORGETTABLE,
  category: "combat",
  tags: ["生死", "战斗", "魔尊", "患难与共"]
});

// 然后对话问："还记得当年那场大战吗？"
// AI 会回忆起这段往事！
```

---

**准备好，开始你的演示吧！** 🎬
