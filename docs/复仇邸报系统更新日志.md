# 复仇邸报系统更新日志

## v1.2.0 - 2026年1月27日

### 🎉 重大功能

#### ⚔️ 完整的复仇系统
实现了基于邸报的复仇玩法，玩家可以通过散布谣言削弱宿敌，管理威胁度避免被刺杀，最终发起生死决斗完成复仇。

### ✨ 新增内容

#### 核心模块
- **revengeSystem.js**: 完整的复仇系统逻辑
  - `spreadRumor()`: 散布谣言功能
  - `hideFromRival()`: 隐匿行踪功能
  - `finalDuel()`: 生死决斗功能
  - `checkAssassinationEvent()`: 刺杀事件检测
  - `updateRivalTimeline()`: 宿敌时间线更新
  - `generateThreatWarning()`: 威胁度预警生成

#### 数据结构
- **initialPlayer.js**: 新增 `rival` 和 `revengeActions` 数据结构
  - 宿敌状态跟踪（state, lifeStage, threatLevel, rumorCount等）
  - 复仇操作记录（lastRumorMonth, totalRumors等）

#### 新闻模板
- **newsTemplates.js**: 新增11类复仇相关新闻模板
  - `RIVAL_RISE`: 宿敌崛起（天才突破）
  - `RIVAL_ENGAGED`: 宿敌订婚
  - `RIVAL_MARRIAGE`: 宿敌结婚（金玉良缘）
  - `RIVAL_HEIR`: 宿敌生子掌权
  - `RIVAL_LIGHT_RUMOR`: 轻度谣言效果（走火入魔）
  - `RIVAL_HEAVY_RUMOR`: 重度谣言效果（人设崩塌）
  - `RIVAL_THREAT_MEDIUM`: 中度威胁预警（悬赏令）
  - `RIVAL_THREAT_HIGH`: 高度威胁预警（全城搜捕）
  - `RIVAL_THREAT_CRITICAL`: 极度危险预警（血榜杀手）
  - `RIVAL_HIDE_SUCCESS`: 隐匿成功反馈
  - `RIVAL_DEFEATED`: 复仇成功（震撼结局）
  - `RIVAL_VICTORY`: 宿敌胜利（挑战失败）

#### 邸报系统增强
- **gazetteSystem.js**: 实现优先级新闻生成
  - 优先级1: 高威胁预警（Gameplay关键）
  - 优先级2: 宿敌时间线事件
  - 优先级3: 玩家操作反馈
  - 优先级4: 日常新闻和填充

#### UI组件
- **RevengePanel.jsx**: 完整的复仇操作界面
  - 宿敌状态展示（境界、状态、威胁度、谣言效果）
  - 威胁度进度条（颜色分级：绿→黄→橙→红）
  - 高危预警提示（闪烁动画）
  - 散布谣言操作（灵石投入可调节50-150）
  - 隐匿行踪操作（月数可选1-3）
  - 生死决斗操作（战力对比展示）
  - 操作结果实时反馈（Toast提示）
  - 复仇完成状态展示
  - 响应式设计（移动端适配）

#### 文档
- **复仇邸报系统使用指南.md**: 完整的系统说明
- **复仇邸报系统实现总结.md**: 技术实现文档
- **复仇邸报系统快速开始.md**: 新手入门指南

### 🎮 玩法特色

#### 文字即演出
通过邸报新闻模拟宿敌的"凡尔赛人生"：
- 第1年："楚清瑶一月筑基，打破百年记录！"
- 第2年："顾家少主与楚清瑶订婚，十里红妆！"
- 第3年："金玉良缘！楚清瑶大婚，羡煞旁人！"
- 第5年："楚清瑶喜得麟儿，被立为家主继承人！"

#### 预警即Gameplay
威胁度预警不仅是剧情提示，更是核心玩法机制：
- 30%: "楚家发布悬赏令，寻找神秘女修..."
- 60%: "全城戒严！挖地三尺也要找出来！"
- 80%: "血榜杀手现身，要在三日内取人首级！"（必须立即隐匿）

#### 风险收益平衡
- 散布轻度谣言（50灵石）：削弱100修为，威胁+10
- 散布重度谣言（100灵石）：削弱200修为，威胁+25
- 隐匿1月（30灵石）：威胁-40
- 隐匿3月（90灵石）：威胁清零

#### 时间压力驱动
宿敌成长速度快于玩家：
- 开局：炼气初期（修为300）
- 第1年：筑基期（修为800）
- 第3年：金丹初期（修为1500）
- 第5年：金丹中期（修为2000）
- 每年自然成长+200修为

### 🔧 技术亮点

#### 模块化设计
- 复仇系统完全解耦，可独立测试
- 所有状态存储在 `player.rival`，便于保存/加载
- 操作返回 `newsEvent` 对象，自动推送到邸报

#### 状态驱动
- 宿敌状态（NORMAL → ANXIOUS → FURIOUS → DEAD）
- 威胁度系统（0-100%，分级预警）
- 生命阶段（0-4，自动触发时间线事件）

#### 优先级调度
```
高威胁预警（强制置顶）
    ↓
时间线事件（剧情驱动）
    ↓
操作反馈（玩家行为）
    ↓
日常新闻（填充）
```

#### 向后兼容
- RevengePanel 组件兼容旧的 `onAction` 接口
- 渐进式集成，不影响现有功能

### 📊 平衡性数据

#### 战力计算
```
玩家战力 = 修为 + 攻击力 × 10
宿敌战力 = (修为 + 500) × (1 - 谣言次数 × 5%)
胜率 = 玩家战力 / (玩家战力 + 宿敌战力)
```

#### 谣言削弱效果
- 1次谣言: -5%战力
- 5次谣言: -25%战力
- 10次谣言: -50%战力

#### 刺杀事件
- 触发条件: 威胁度 ≥ 80 且不在隐匿期
- 触发概率: 50%
- 生存率: 30% + 机敏/200（最高60%）
- 幸存惩罚: HP降至40%，威胁度-20
- 死亡结果: 游戏结束

### 🎯 推荐玩法

#### 稳健路线（推荐新手）
1. 第1-2年：专注修炼到筑基期
2. 第3-4年：每月散布50灵石谣言，每3次隐匿1月
3. 第5年：累积5次谣言后发起决斗

#### 激进路线（高风险高回报）
1. 第1年：修炼到炼气后期
2. 第2年：疯狂散布100灵石重度谣言
3. 第3年：宿敌结婚前发起决斗

#### 极限路线（终极挑战）
1. 修炼到金丹期
2. 不散布谣言，正面硬刚
3. 用绝对实力碾压

### 🐛 已知问题

无（初版发布）

### 📝 待办事项

#### 短期
- [ ] 集成到游戏主循环（时间推进时调用检测函数）
- [ ] 保存系统更新（确保 rival 数据能保存）
- [ ] UI多处显示威胁度警告

#### 中期
- [ ] AI生成个性化复仇新闻
- [ ] 威胁度变化动画效果
- [ ] 高危预警音效

#### 长期
- [ ] 多宿敌系统
- [ ] 复仇支线任务
- [ ] 阵营影响系统
- [ ] 复仇成就系统

### 💡 设计理念

> "不需要复杂的 3D 演出，文字的力量足矣。"

复仇邸报系统通过单一的邸报渠道，实现了：
- ✅ 宿敌互动（时间线事件）
- ✅ 威胁管理（预警系统）
- ✅ 复仇操作（谣言、隐匿、决斗）
- ✅ 情绪落差（光鲜与崩坏的对比）

整个系统保持简单数据结构 + 清晰优先级，让玩家专注于策略决策，而非复杂操作。

### 🎉 总结

这次更新为游戏带来了全新的复仇玩法维度，玩家不再是被动修炼，而是要主动管理与宿敌的关系，在散布谣言削弱对方和管理威胁度之间取得平衡，最终在合适的时机发起决斗，完成复仇大业。

整个过程充满策略性和紧张感，通过邸报这个"战况转播"渠道，用文字营造出强烈的情绪体验。

**愿你早日手刃仇敌，了却心头之恨！** ⚔️

---

**版本**: v1.2.0  
**发布日期**: 2026年1月27日  
**作者**: GitHub Copilot  
**参考设计**: 用户提供的复仇系统设计文档
